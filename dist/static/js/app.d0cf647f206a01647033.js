webpackJsonp([1],{"+BTi":function(t,e){},"/U5+":function(t,e){},"2rGO":function(t,e){},BWar:function(t,e){},D7gr:function(t,e,i){t.exports=i.p+"static/img/img_painting_page_title.a310a10.png"},GXEp:function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});i("cwe7"),i("+BTi");var n=i("2X9z"),s=i.n(n),a=(i("Yq4J"),i("qubY")),o=i.n(a),r=(i("2rGO"),i("nu7/")),l=i.n(r),c=(i("BWar"),i("IMy7")),u=i.n(c),p=(i("GXEp"),i("mtrD")),g=i.n(p),d=i("7+uW"),v={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("header",[e("img",{attrs:{src:i("D7gr"),alt:"logo"}})])}]};var f={data:function(){return{serverUrl:"https://gjs.so/painting2018",paintings:[],painting:[],showRate:0,loading:!0,dialogVisible:!1,singlePainting:{},currentRate:0,showListLength:1,slideShow:!1,swiperOption:{slidesPerView:1,spaceBetween:30,loop:!0,pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}},showIntro:""}},methods:{getAllPainting:function(){var t=this;this.$http.get(this.serverUrl+"/allpainting").then(function(e){if(t.loading=!1,200==e.status){var i=e.data.map(function(t,e){return t.imgUrl=JSON.parse(t.imgUrl),t});t.paintings=i.reverse()}else t.loading=!1}).catch(function(t){})},slideShowClicked:function(t){var e=t.target.classList;(e.contains("swiper-container")||e.contains("swipe-container")||e.contains("el-icon-close")||e.contains("swiper-slide"))&&(this.slideShow=!1)},showImg:function(t){this.slideShow=!0,this.painting=t},clickToRate:function(t){this.showIntro=t.description,log(t.description),t.isRated?this.warningMessage("您不可以为这个作品投票"):(this.singlePainting=t,this.dialogVisible=!0)},handleClose:function(){this.dialogVisible=!1},cancel:function(){this.dialogVisible=!1},checkIsRated:function(t){this.paintings.forEach(function(e){e.id==t&&(e.isRated=!0)})},confirm:function(){var t=this;this.dialogVisible=!1;var e=this.currentRate,i=this.singlePainting.id,n={id:i,rateValue:e};this.$http.post(this.serverUrl+"/rate",n).then(function(e){t.successMessage("投票成功了"),t.checkIsRated(i)},function(e){var n=e.response.status;601==n?t.warningMessage("您已经投过票了"):602==n&&t.warningMessage("您不可以为自己的作品投票"),t.checkIsRated(i)})},warningMessage:function(t){this.$message({message:t,type:"warning"})},successMessage:function(t){this.$message({message:t,type:"success"})},rateChange:function(t){this.showRate=t;var e=2*t;this.currentRate=e},listenToUserKeyboard:function(t){"Escape"==t.key&&(this.slideShow=!1)}},created:function(){this.getAllPainting(),window.addEventListener("keyup",this.listenToUserKeyboard,!1)}},h={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("main",[i("ul",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[i("el-dialog",{staticClass:"el-dialog-wrapper",attrs:{title:t.singlePainting.worksName,visible:t.dialogVisible,"before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticClass:"intro"},[t._v(t._s(t.showIntro))]),t._v(" "),i("el-rate",{attrs:{"allow-half":!0,"text-color":"#ff9900"},on:{change:t.rateChange},model:{value:t.showRate,callback:function(e){t.showRate=e},expression:"showRate"}}),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.cancel}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确 定")])],1)],1),t._v(" "),t._l(t.paintings,function(e,n){return i("li",{key:n},[i("div",{staticClass:"img-container",on:{click:function(i){t.showImg(e)}}},[i("div",{staticClass:"img-wrapper"},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.imgUrl[0],expression:"painting.imgUrl[0]"}],attrs:{alt:"img"}})]),t._v(" "),t._m(0,!0)]),t._v(" "),i("div",{staticClass:"content"},[i("div",{staticClass:"worksName"},[t._v(t._s(e.worksName))]),t._v(" "),i("div",{staticClass:"authorName"},[i("span",[t._v("by "+t._s(e.userName))])]),t._v(" "),i("div",{staticClass:"rate-wrapper",on:{click:function(i){t.clickToRate(e)}}},[i("el-rate",{staticClass:"el-rate-inner",attrs:{disabled:"","text-color":"#ff9900",max:5},model:{value:e.averageScore,callback:function(i){t.$set(e,"averageScore",i)},expression:"painting.averageScore"}}),t._v(" "),i("button",{staticClass:"button-rate"},[t._v("评分")])],1),t._v(" "),i("div",{staticClass:"rate-people"},[t._v(t._s(e.ratingPeople)+" 人评分")])])])})],2),t._v(" "),t.slideShow?i("div",{staticClass:"swipe-container2",on:{click:function(e){t.slideShowClicked(e)}}},[i("i",{staticClass:"el-icon-close"}),t._v(" "),i("swiper",{staticClass:"swiper-inner",attrs:{options:t.swiperOption}},[t._l(t.painting.imgUrl,function(t,e){return i("swiper-slide",{key:e,staticClass:"swiper-slide-inner"},[i("img",{staticStyle:{"margin-top":"20px"},attrs:{src:t,alt:"图片详情"}})])}),t._v(" "),i("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"}),t._v(" "),i("div",{staticClass:"swiper-button-prev",attrs:{slot:"button-prev"},slot:"button-prev"},[i("i",{staticClass:"el-icon-caret-left"})]),t._v(" "),i("div",{staticClass:"swiper-button-next",attrs:{slot:"button-next"},slot:"button-next"},[i("i",{staticClass:"el-icon-caret-right"})])],2)],1):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"img-mask"},[e("div",{staticClass:"click-item"},[e("i",{staticClass:"el-icon-zoom-in"})])])}]};var m={name:"App",components:{TopLogo:i("VU/8")({data:function(){return{}},methods:{},created:function(){}},v,!1,function(t){i("eJVR")},"data-v-6ce1219e",null).exports,MainContainer:i("VU/8")(f,h,!1,function(t){i("Xuj6")},"data-v-5c104ea2",null).exports}},w={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("top-logo"),this._v(" "),e("main-container")],1)},staticRenderFns:[]};var _=i("VU/8")(m,w,!1,function(t){i("/U5+")},null,null).exports,b=i("mtWM"),C=i.n(b),k=i("Au9i"),R=i("7QTg"),y=i.n(R);i("v2ns");d.default.use(k.Lazyload),d.default.config.productionTip=!1,window.log=console.log.bind(this),d.default.use(y.a),d.default.use(g.a),d.default.use(u.a),d.default.use(l.a),d.default.use(o.a),d.default.prototype.$message=s.a,d.default.prototype.$http=C.a,new d.default({el:"#app",components:{App:_},template:"<App/>"})},Xuj6:function(t,e){},Yq4J:function(t,e){},cwe7:function(t,e){},eJVR:function(t,e){},v2ns:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.d0cf647f206a01647033.js.map