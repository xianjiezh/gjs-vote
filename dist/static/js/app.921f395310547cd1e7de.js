webpackJsonp([1],{"+BTi":function(t,i){},"/U5+":function(t,i){},"2rGO":function(t,i){},BWar:function(t,i){},D7gr:function(t,i,e){t.exports=e.p+"static/img/img_painting_page_title.a310a10.png"},GXEp:function(t,i){},NHnr:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});e("cwe7"),e("+BTi");var n=e("2X9z"),s=e.n(n),a=(e("Yq4J"),e("qubY")),o=e.n(a),r=(e("2rGO"),e("nu7/")),l=e.n(r),c=(e("BWar"),e("IMy7")),u=e.n(c),p=(e("GXEp"),e("mtrD")),g=e.n(p),d=e("7+uW"),f={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,i=this._self._c||t;return i("header",[i("img",{attrs:{src:e("D7gr"),alt:"logo"}})])}]};var v={data:function(){return{serverUrl:"https://gjs.so/painting2018",paintings:[],painting:[],showRate:0,loading:!0,dialogVisible:!1,singlePainting:{},currentRate:0,showListLength:1,slideShow:!1,swiperOption:{slidesPerView:1,spaceBetween:30,loop:!0,pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}},showIntro:""}},methods:{getAllPainting:function(){var t=this;this.$http.get(this.serverUrl+"/allpainting").then(function(i){t.loading=!1,200==i.status?t.paintings=i.data.map(function(t,i){return t.imgUrl=JSON.parse(t.imgUrl),t}):t.loading=!1}).catch(function(t){})},slideShowClicked:function(t){var i=t.target.classList;(i.contains("swiper-container")||i.contains("swipe-container")||i.contains("el-icon-close")||i.contains("swiper-slide"))&&(this.slideShow=!1)},showImg:function(t){this.slideShow=!0,this.painting=t},clickToRate:function(t){this.showIntro=t.description,log(t.description),t.isRated?this.warningMessage("您不可以为这个作品投票"):(this.singlePainting=t,this.dialogVisible=!0)},handleClose:function(){this.dialogVisible=!1},cancel:function(){this.dialogVisible=!1},checkIsRated:function(t){this.paintings.forEach(function(i){i.id==t&&(i.isRated=!0)})},confirm:function(){var t=this;this.dialogVisible=!1;var i=this.currentRate,e=this.singlePainting.id,n={id:e,rateValue:i};this.$http.post(this.serverUrl+"/rate",n).then(function(i){t.successMessage("投票成功了"),t.checkIsRated(e)},function(i){var n=i.response.status;601==n?t.warningMessage("您已经投过票了"):602==n&&t.warningMessage("您不可以为自己的作品投票"),t.checkIsRated(e)})},warningMessage:function(t){this.$message({message:t,type:"warning"})},successMessage:function(t){this.$message({message:t,type:"success"})},rateChange:function(t){this.showRate=t;var i=2*t;this.currentRate=i},listenToUserKeyboard:function(t){"Escape"==t.key&&(this.slideShow=!1)}},created:function(){this.getAllPainting(),window.addEventListener("keyup",this.listenToUserKeyboard,!1)}},h={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("main",[e("ul",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[e("el-dialog",{staticClass:"el-dialog-wrapper",attrs:{title:t.singlePainting.worksName,visible:t.dialogVisible,"before-close":t.handleClose},on:{"update:visible":function(i){t.dialogVisible=i}}},[e("div",{staticClass:"intro"},[t._v(t._s(t.showIntro))]),t._v(" "),e("el-rate",{attrs:{"allow-half":!0,"text-color":"#ff9900"},on:{change:t.rateChange},model:{value:t.showRate,callback:function(i){t.showRate=i},expression:"showRate"}}),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.cancel}},[t._v("取 消")]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确 定")])],1)],1),t._v(" "),t._l(t.paintings,function(i,n){return e("li",{key:n},[e("div",{staticClass:"img-container",on:{click:function(e){t.showImg(i)}}},[e("div",{staticClass:"img-wrapper"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:i.imgUrl[0],expression:"painting.imgUrl[0]"}],attrs:{alt:"img"}})]),t._v(" "),t._m(0,!0)]),t._v(" "),e("div",{staticClass:"content"},[e("div",{staticClass:"worksName"},[t._v(t._s(i.worksName))]),t._v(" "),e("div",{staticClass:"authorName"},[e("span",[t._v("by "+t._s(i.userName))])]),t._v(" "),e("div",{staticClass:"rate-wrapper",on:{click:function(e){t.clickToRate(i)}}},[e("el-rate",{staticClass:"el-rate-inner",attrs:{disabled:"","text-color":"#ff9900",max:5},model:{value:i.averageScore,callback:function(e){t.$set(i,"averageScore",e)},expression:"painting.averageScore"}}),t._v(" "),e("button",{staticClass:"button-rate"},[t._v("评分")])],1),t._v(" "),e("div",{staticClass:"rate-people"},[t._v(t._s(i.ratingPeople)+" 人评分")])])])})],2),t._v(" "),t.slideShow?e("div",{staticClass:"swipe-container2",on:{click:function(i){t.slideShowClicked(i)}}},[e("i",{staticClass:"el-icon-close"}),t._v(" "),e("swiper",{staticClass:"swiper-inner",attrs:{options:t.swiperOption}},[t._l(t.painting.imgUrl,function(t,i){return e("swiper-slide",{key:i,staticClass:"swiper-slide-inner"},[e("img",{staticStyle:{"margin-top":"20px"},attrs:{src:t,alt:"图片详情"}})])}),t._v(" "),e("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"}),t._v(" "),e("div",{staticClass:"swiper-button-prev",attrs:{slot:"button-prev"},slot:"button-prev"},[e("i",{staticClass:"el-icon-caret-left"})]),t._v(" "),e("div",{staticClass:"swiper-button-next",attrs:{slot:"button-next"},slot:"button-next"},[e("i",{staticClass:"el-icon-caret-right"})])],2)],1):t._e()])},staticRenderFns:[function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"img-mask"},[i("div",{staticClass:"click-item"},[i("i",{staticClass:"el-icon-zoom-in"})])])}]};var m={name:"App",components:{TopLogo:e("VU/8")({data:function(){return{}},methods:{},created:function(){}},f,!1,function(t){e("eJVR")},"data-v-6ce1219e",null).exports,MainContainer:e("VU/8")(v,h,!1,function(t){e("NxYg")},"data-v-7dc214cc",null).exports}},w={render:function(){var t=this.$createElement,i=this._self._c||t;return i("div",{attrs:{id:"app"}},[i("top-logo"),this._v(" "),i("main-container")],1)},staticRenderFns:[]};var _=e("VU/8")(m,w,!1,function(t){e("/U5+")},null,null).exports,b=e("mtWM"),C=e.n(b),k=e("Au9i"),R=e("7QTg"),x=e.n(R);e("v2ns");d.default.use(k.Lazyload),d.default.config.productionTip=!1,window.log=console.log.bind(this),d.default.use(x.a),d.default.use(g.a),d.default.use(u.a),d.default.use(l.a),d.default.use(o.a),d.default.prototype.$message=s.a,d.default.prototype.$http=C.a,new d.default({el:"#app",components:{App:_},template:"<App/>"})},NxYg:function(t,i){},Yq4J:function(t,i){},cwe7:function(t,i){},eJVR:function(t,i){},v2ns:function(t,i){}},["NHnr"]);
//# sourceMappingURL=app.921f395310547cd1e7de.js.map